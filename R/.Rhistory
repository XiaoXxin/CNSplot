exp <- read.table(file = "./rawData/2024-11-18_172030.txt", sep = "\t", header = T, fill = T)
exp <- data.frame(sample = exp$Sample.Name, group = exp$Sample.Name, gene = exp$Target.Name, ct = exp$CT)
exp$ct[exp$ct == "Undetermined"] <- "40"
exp$ct <- as.numeric(exp$ct)
View(exp)
help(gsub)
gsub("UTD.*", "UTD", exp$group)
exp$group <- gsub("UTD.*", "UTD", exp$group)
View(exp)
exp$group <- gsub("YX3.*", "CIMB7", exp$group)
View(exp)
exp <- read.table(file = "./rawData/2024-11-18_172030.txt", sep = "\t", header = T, fill = T)
exp <- data.frame(sample = exp$Sample.Name, group = exp$Sample.Name, gene = exp$Target.Name, ct = exp$CT)
exp$ct[exp$ct == "Undetermined"] <- "40"
exp$ct <- as.numeric(exp$ct)
exp$group <- gsub("UTD.*", "UTD", exp$group)
exp$group <- gsub("YX3.*", "COMB7", exp$group)
View(exp)
exp_sum <- rq_calcu(exp, gene_ctrl = "GAPDH", sample_ctrl = "UTD")
library(CNSplot)
library(tidyverse)
exp_sum <- rq_calcu(exp, gene_ctrl = "GAPDH", sample_ctrl = "UTD")
View(exp_sum)
#####
dat = exp_sum[exp_sum$gene == "J591-2",]
View(dat)
dat$group <- factor(dat$group, levels = c("UTD", "COMB7"))
View(dat)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("CON","COMB7")),
text.x = c("CON","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR",
angle.x = 45,
size.p = 4,
jitter.width = 0.2,
nudge.p = c(1200,1.1,1.1),
aspect.ratio = 1.8)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("CON","COMB7")),
text.x = c("CON","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR",
angle.x = 45,
size.p = 4,
nudge.p = c(1200,1.1,1.1),
aspect.ratio = 1.8)
View(dat)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR",
angle.x = 45,
size.p = 4,
nudge.p = c(1200,1.1,1.1),
aspect.ratio = 1.8)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
View(dat)
View(dat)
View(exp)
expList <- split(exp, ~group)
View(expList)
library(CNSplot)
library(tidyverse)
exp <- read.table(file = "./rawData/2024-11-18_172030.txt", sep = "\t", header = T, fill = T)
View(exp)
exp <- data.frame(sample = exp$Sample.Name, group = exp$Sample.Name, gene = exp$Target.Name, ct = exp$CT)
exp$ct[exp$ct == "Undetermined"] <- "40"
exp$ct <- as.numeric(exp$ct)
exp$group <- gsub("UTD.*", "UTD", exp$group)
exp$group <- gsub("YX3.*", "COMB7", exp$group)
View(exp)
expList <- split(exp, ~group)
View(expList)
View(exp)
exp <- read.table(file = "./rawData/2024-11-18_172030.txt", sep = "\t", header = T, fill = T)
exp <- data.frame(sample = exp$Sample.Name, group = exp$Sample.Name, gene = exp$Target.Name, ct = exp$CT)
exp$ct[exp$ct == "Undetermined"] <- "40"
exp$ct <- as.numeric(exp$ct)
View(exp)
exp_sum <- rq_calcu(exp, gene_ctrl = "GAPDH", sample_ctrl = "UTD")
View(exp_sum)
expList <- split(exp, ~group)
View(expList)
expList <- lapply(expList, function(x) {
ct_mean_ctrl <- mean(x$ct[x$gene == gene_ctrl])
x <- x[x$gene != gene_ctrl,]
x$dct <- x$ct- ct_mean_ctrl
x
})
gene_ctrl = "GAPDH"
expList <- lapply(expList, function(x) {
ct_mean_ctrl <- mean(x$ct[x$gene == gene_ctrl])
x <- x[x$gene != gene_ctrl,]
x$dct <- x$ct- ct_mean_ctrl
x
})
View(expList)
expList <- Reduce(rbind, expList)
expList <- split(expList, ~gene)
View(expList)
sample_ctrl = "UTD1"
expList <- lapply(expList, function(y) {
dct_mean_ctrl <- mean(y$dct[y$group == sample_ctrl])
y$ddct <- y$dct- dct_mean_ctrl
y$exp <- 2^(y$ddct*-1)
rq_mean_ctrl <- mean(y$exp[y$group == sample_ctrl])
y$exp <- y$exp/rq_mean_ctrl
y
})
View(expList)
exp_sum <- rq_calcu(exp, gene_ctrl = "GAPDH", sample_ctrl = "UTD1")
View(exp_sum)
exp <- read.table(file = "./rawData/2024-11-18_172030.txt", sep = "\t", header = T, fill = T)
exp <- data.frame(sample = exp$Sample.Name, group = exp$Sample.Name, gene = exp$Target.Name, ct = exp$CT)
exp$ct[exp$ct == "Undetermined"] <- "40"
exp$ct <- as.numeric(exp$ct)
exp$group <- gsub("UTD.*", "UTD", exp$group)
exp$group <- gsub("YX3.*", "COMB7", exp$group)
View(exp)
expList <- split(exp, ~sample)
View(expList)
expList <- lapply(expList, function(x) {
ct_mean_ctrl <- mean(x$ct[x$gene == gene_ctrl])
x <- x[x$gene != gene_ctrl,]
x$dct <- x$ct- ct_mean_ctrl
x
})
View(expList)
expList <- Reduce(rbind, expList)
expList <- split(expList, ~gene)
View(expList)
sample_ctrl = "UTD"
expList <- lapply(expList, function(y) {
dct_mean_ctrl <- mean(y$dct[y$group == sample_ctrl])
y$ddct <- y$dct- dct_mean_ctrl
y$exp <- 2^(y$ddct*-1)
rq_mean_ctrl <- mean(y$exp[y$group == sample_ctrl])
y$exp <- y$exp/rq_mean_ctrl
y
})
expList <- Reduce(rbind, expList)
#####
dat = exp_sum[exp_sum$gene == "J591-2",]
View(exp_sum)
dat$group <- factor(dat$group, levels = c("UTD", "COMB7"))
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
View(dat)
#####
dat = exp_sum[exp_sum$gene == "J591-2",]
View(dat)
View(exp_sum)
exp <- read.table(file = "./rawData/2024-11-18_172030.txt", sep = "\t", header = T, fill = T)
exp <- data.frame(sample = exp$Sample.Name, group = exp$Sample.Name, gene = exp$Target.Name, ct = exp$CT)
exp$ct[exp$ct == "Undetermined"] <- "40"
exp$ct <- as.numeric(exp$ct)
exp$group <- gsub("UTD.*", "UTD", exp$group)
exp$group <- gsub("YX3.*", "COMB7", exp$group)
View(exp)
#' @param group
#' @param gene
#' @param ct
#' @param gene_ctrl
#' @param sample_ctrl
#'
#' @return
#' @export
#'
#' @examples
rq_calcu <- function(exp, group = "group", gene = "gene", ct = "ct", gene_ctrl, sample_ctrl){
colnames(exp)[colnames(exp) == group] <- "group"
colnames(exp)[colnames(exp) == gene] <- "gene"
colnames(exp)[colnames(exp) == ct] <- "ct"
expList <- split(exp, ~sample)
expList <- lapply(expList, function(x) {
ct_mean_ctrl <- mean(x$ct[x$gene == gene_ctrl])
x <- x[x$gene != gene_ctrl,]
x$dct <- x$ct- ct_mean_ctrl
x
})
expList <- Reduce(rbind, expList)
expList <- split(expList, ~gene)
expList <- lapply(expList, function(y) {
dct_mean_ctrl <- mean(y$dct[y$group == sample_ctrl])
y$ddct <- y$dct- dct_mean_ctrl
y$exp <- 2^(y$ddct*-1)
rq_mean_ctrl <- mean(y$exp[y$group == sample_ctrl])
y$exp <- y$exp/rq_mean_ctrl
y
})
expList <- Reduce(rbind, expList)
expList
}
exp_sum <- rq_calcu(exp, gene_ctrl = "GAPDH", sample_ctrl = "UTD")
View(exp_sum)
#####
dat = exp_sum[exp_sum$gene == "J591-2",]
View(dat)
dat$group <- factor(dat$group, levels = c("UTD", "COMB7"))
View(dat)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = "white",
lab.y = "Relative mRNA expression",
title = "CAR Enrichment",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = c("#418FDEFF", "#003DA5FF"),
lab.y = "Relative mRNA expression",
title = "CAR Enrichment",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
help(plotBPE_T)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = c("#EA7580FF", "#172869FF"),
lab.y = "Relative mRNA expression",
title = "CAR Enrichment",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = c("#EA7580FF", "#1BB6AFFF"),
lab.y = "Relative mRNA expression",
title = "CAR Enrichment",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = c("#1BB6AFFF","#EA7580FF"),
lab.y = "Relative mRNA expression",
title = "CAR Enrichment",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
p1 <- plotBPE_T(dat = dat,
formula = exp ~ group,
comparisons = list(c("UTD","COMB7")),
text.x = c("UTD","COMB7"),
fill = c("#1BB6AFFF","#EA7580FF"),
lab.y = "Relative mRNA expression",
title = "CAR Enrichment",
angle.x = 45,
size.p = 4,
aspect.ratio = 1.8)
pdf(file = "./plot/plot_CARinfil.pdf", width = 3, height = 4)
pdf(file = "./plot/plot_CARinfil.pdf", width = 3, height = 4)
p1
dev.off()
detach("package:CNSplot", unload = TRUE)
remove.packages("CNSplot")
setwd("W:/library_lib132/results/R/CNSplot/R")
devtools::document()
devtools::document()
