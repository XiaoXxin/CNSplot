geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))
help(coord_fixed)
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ratio = 1,ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ratio = 3, ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ratio = 0.1, ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ratio = 0.01, ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ratio = 0.001, ylim = c(ylims[1], ylims[2]))
ylims[2]/nrow(dat)
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(aspect.ratio = 1,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(aspect.ratio = 2,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
library(pheatmap)
help("pheatmap")
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)
}
plot_B = T
plot_P = T
plot_E = T
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)
}
p
if(plot_E){
p <- p+geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
help(geom_errorbar)
plot_B = F
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.9, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p <- p+geom_point(data = dat, aes(y = exp), shape = 21, size = 2, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))
p
help(position_dodge)
View(dat_sum)
levels = c("UTD", "nf1", "nf2", "nf3", "nf5", "mp6", "mp9")
levels = c("UTD", "nf1", "nf2", "nf3", "nf5", "mp6", "mp9")
dat <- read.table(file = "./rawData/tnf.txt", sep = "\t", header = T, fill = T)
dat <- gather(dat, group, exp) %>% mutate(group = factor(group, levels = levels))
levels = c("UTD", "nf1", "nf2", "nf3", "nf5", "mp6", "mp9")
plot_B = F
lab.sample = NUL
lab.sample = NULL
lab.x = ""
lab.y = ""
size.text.x = 10
size.text.y = 10
size.point = 2
title = ""
library(tidyverse)
ylims = c(0,3000)
aspect.ratio = 0.5
dat <- gather(dat, group, exp) %>% mutate(group = factor(group, levels = levels))
dat_sum <- dat %>%
dplyr::group_by(group) %>%
dplyr::summarise(mean = mean(exp),
n = length(exp),
sd = sd(exp),
sem = sd/sqrt(n)) %>%
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
dat_sum <- dat %>%
dplyr::group_by(group) %>%
dplyr::summarise(mean = mean(exp),
n = length(exp),
sd = sd(exp),
sem = sd/sqrt(n))
str(dat_sum )
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.9, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p
fill = "black"
if(length(fill) == 1){fill = rep(fill, nrow(dat))}
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.9, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p
if(is.null(lab.sample)){lab.sample = levels}
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.9, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p <- p+geom_point(data = dat, aes(y = exp), shape = 21, size = size.point, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))
p
fill = "black"
while(length(fill) < nrow(dat)){
fill <- filc(fill,fill)
}
while(length(fill) < nrow(dat)){
fill <- c(fill,fill)
}
fill <- fill[1:nrow(dat)]
fill = c("blue", "red")
dat <- read.table(file = "./rawData/tnf.txt", sep = "\t", header = T, fill = T)
dat <- gather(dat, group, exp) %>% mutate(group = factor(group, levels = levels))
dat_sum <- dat %>%
dplyr::group_by(group) %>%
dplyr::summarise(mean = mean(exp),
n = length(exp),
sd = sd(exp),
sem = sd/sqrt(n))
while(length(fill) < nrow(dat)){
fill <- c(fill,fill)
}
fill <- fill[1:nrow(dat)]
if(is.null(lab.sample)){lab.sample = levels}
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.5, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.9, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p <- p+geom_point(data = dat, aes(y = exp), shape = 21, size = size.point, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))
p
View(dat)
fill = c("blue", "red")
while(length(fill) < nrow(dat_sum)){
fill <- c(fill,fill)
}
fill <- fill[1:nrow(dat_sum)]
if(is.null(lab.sample)){lab.sample = levels}
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.5, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.9, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.9, linewidth = 1)
}
p <- p+geom_point(data = dat, aes(y = exp), shape = 21, size = size.point, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))
p
plot_B = T
fill = "black"
while(length(fill) < nrow(dat_sum)){
fill <- c(fill,fill)
}
fill <- fill[1:nrow(dat_sum)]
if(is.null(lab.sample)){lab.sample = levels}
p <- ggplot(dat_sum, aes(x = group, y = mean, fill = group))+
labs(x= lab.x, y = lab.y)+
guides(fill = "none")+
ggtitle(title)+
scale_x_discrete(expand = c(0,0))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values = fill, labels = lab.sample)+
theme_bw()+
theme(aspect.ratio = 0.5,
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.grid = element_blank(),
axis.text.x = element_text(size = size.text.x),
axis.text.y = element_text(size = size.text.y))+
coord_fixed(ylim = c(ylims[1], ylims[2]))
if(plot_B){
p <- p+geom_bar(position = position_dodge(1), stat = "identity", color = "black", alpha = 0.6, width=0.6)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.5, linewidth = 1)
}else{
p <- p+geom_errorbar(aes(x = group, ymin = mean, ymax = mean),
position = position_dodge(1), width = 0.5, color = "black", alpha = 0.5, linewidth = 1)+
geom_errorbar(aes(x = group, ymin = mean-sem, ymax = mean+sem),
position = position_dodge(1), width = 0.3, color = "black", alpha = 0.5, linewidth = 1)
}
p <- p+geom_point(data = dat, aes(y = exp), shape = 21, size = size.point, show.legend = FALSE, color = "black",
position = position_jitterdodge(0.2, dodge.width = 1))
p
setwd("W:/library_lib132/results/R/CNSplot/R")
setwd("W:/library_lib132/results/R/CNSplot/R")
